---
title: "Tidy Tuesday - January 17, 2023"
output: html_notebook
---
```{r Libraries, Fonts, Data}
library(tidyverse)
library(showtext)
library(cowplot)
library(treemapify)

#fonts
font_add_google("Playfair Display")
showtext_auto()
#Read in data
tuesdata <- tidytuesdayR::tt_load(2023, week = 3)
```

```{r data}
artists <- tuesdata$artists %>%
  filter(artist_nationality == "American") %>%
  group_by(artist_name, artist_gender, artist_race, artist_ethnicity, book) %>%
  summarise(total_count = n()) %>%
  mutate(artist_gender = as_factor(artist_gender))
```

```{r Gender by Book}
plotGenderTM_Gardner <- artists %>%
  filter(book == "Gardner") %>%
  ggplot(aes(area = total_count, fill = artist_gender, 
             label = paste(artist_name),
             subgroup = artist_gender)) +
  geom_treemap(layout = "fixed") +
  geom_treemap_subgroup_border(layout = "fixed") +
  geom_treemap_text(colour = "white", family = "Playfair Display", 
                    place = "centre", grow = TRUE, layout = "fixed") +
  scale_fill_manual(values = c("cadetblue", "darksalmon", "gray")) +
  theme_minimal() +
  theme(legend.position = "none")

plotGenderTM_Janson <- artists %>%
  filter(book == "Janson") %>%
  ggplot(aes(area = total_count, fill = artist_gender, 
             label = paste(artist_name),
             subgroup = artist_gender)) +
  geom_treemap(layout = "fixed") +
  geom_treemap_subgroup_border(layout = "fixed") +
  geom_treemap_text(colour = "white", family = "Playfair Display", 
                    place = "centre", grow = TRUE, layout = "fixed") +
  scale_fill_manual(values = c("cadetblue", "darksalmon", "gray")) +
  theme_minimal() +
  theme(legend.position = "none")
```

```{r Race by Book}
plotRaceTM_Gardner <- artists %>%
  filter(book == "Gardner") %>%
  ggplot(aes(area = total_count, fill = artist_race, 
             label = artist_race,
             subgroup = artist_race)) +
  geom_treemap() +
  geom_treemap_subgroup_border() +
  #geom_treemap_subgroup_text(place = "centre", grow = TRUE, colour = "black", 
                    #family = "Playfair Display") +
  #scale_fill_manual(values = c("cadetblue", "darksalmon", "gray")) +
  theme_minimal() +
  theme(legend.position = "none")

plotRaceTM_Janson <- artists %>%
  filter(book == "Janson") %>%
  ggplot(aes(area = total_count, fill = artist_race, 
             label = artist_race,
             subgroup = artist_race)) +
  geom_treemap() +
  geom_treemap_subgroup_border() +
  #geom_treemap_subgroup_text(place = "centre", grow = TRUE, colour = "black", 
                    #family = "Playfair Display") +
  #scale_fill_manual(values = c("cadetblue", "darksalmon", "gray")) +
  theme_minimal() +
  theme(legend.position = "none")
```